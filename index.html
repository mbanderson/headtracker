<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Virtual Reality Headtracker" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>VR Headtracker</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/mbanderson/headtracker/">View on GitHub</a>

          <h1 id="project_title">Virtual Reality Headtracker</h1>
          <h2 id="project_tagline">Michael Anderson and Jin Woo Park</h2>

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>The Next Leap</h1>

	<!-- Background -->
	<p>
	Virtual reality is poised to change how the world consumes entertainment, communicates, and explores new worlds. Many companies are working to bring a seamless virtual reality experience to the market. For head-mounted display systems, this requires accurately tracking the motion of the user's head. As the user looks about in the real world, the display of the virtual world must closely reflect their motion.
	</p>
	<!-- VR Headsets Image -->
	<center>
		<figure>
			<img src="/headertracker/images/GeneralImages/headsets.jpg" alt="VR Headsets" height="300" width="500" 	align="middle">
			<figcaption>The VR community continues to grow. Source: <a href="http://heavy.com/tech/2015/07/best-vr-virtual-reality-headset-glasses-goggles-oculus-rift-specs-review/">Heavy.com</a>
            </figcaption>	
		</figure>
	</center>

	<!-- Our Contribution -->
	<p>
	We developed a virtual reality headtracker based on an Extended Kalman Filter (EKF) with representative measurement models. We evaluated our system for various sensor placements, then incorporated a novel accelerometer constellation design. Our results demonstrate the accelerometer constellation improves head-tracking performance over traditional systems, at the cost of additional computational complexity.
	</p>
	<!-- Side-by-Side Image -->
	<center>
		<figure>
			<img src="/headertracker/images/BlenderAnimations/TruthConstellationResultsForever.gif" alt="Truth vs. Constellation" height="400" width="600">
			<figcaption>Our headtracking system accurately estimates the user's true head orientation</figcaption>
		</figure>
	</center>

    <h1>Building a Headtracker</h1>
	<p>
	There are several approaches to constructing a headtracking sytem. <a href="http://msl.cs.illinois.edu/~lavalle/papers/LavYerKatAnt14.pdf">LaValle et al.</a> outline the process by which the Oculus Rift headset tracks user head orientation and position. The headset incorporates measurements from a 3-axis gyroscope, accelerometer, and magnetometer. We describe this approach below:
	<ol>
		<li>Update approximate head orientation with gyroscope measurement</li>
		<li>Compute expected gravity and magnetic field vectors at estimated orientation</li>
		<li>Fuse accelerometer and magnetometer measurements with computationally cheap filter</li>
	</ol>
	</p>
	We implemented this approach and selected an EKF based on the recommendation by <a href="http://ieeexplore.ieee.org/abstract/document/1243440/?reload=true">LaViola</a>. Our system kinematics are governed by quaternion motion, and our sensor noise parameters were determined by sampling a low-cost MEMS <a href="https://www.sparkfun.com/products/11028">IMU</a> and <a href="https://www.sparkfun.com/products/retired/10530">magnetometer</a>.
	</p>
	<p>
	We considered the performance of our headtracker with four different sensor placements and configurations.
	</p>

	<h1>Headtracker Performance</h1>
	<h4>Center of Head Measurements</h4>
	<p>
	The Center of Head configuration represents the "ideal" sensor placement, in which the accelerometer is mounted at the center of rotation of the user's head. This is extremely impractical for a head-mounted VR system, but it is a useful test case. At the center of rotation, the accelerometer does not experience any acceleration due to rotation. The accelerometer, then, only measures the noisy gravity vector (which directly conveys headset orientation information). In the subsequent configurations, additional work must be performed to isolate the gravity vector.
	</p>
	<center>
	<table cellpadding="0" cellspacing="0" border="0">
		<tr>
			<td valign="top">
				<figure>
					<img src="/headertracker/images/ConfigurationResults/centerofhead.gif" alt="Center of Head Simulation" height="400" width="500">
					<figcaption>Center of Head Simulation</figcaption>
				</figure>
			</td>
			<td valign="top" width="300">
				<figure>
					<img src="/headertracker/images/GeneralImages/CenterOfHeadDiagram.PNG" height="400" width="300">
					<figcaption>Sensor placement in center of head configuration. Source: <a href="http://msl.cs.illinois.edu/~lavalle/papers/LavYerKatAnt14.pdf">Oculus VR</a>
                    </figcaption>
				</figure>
			</td>
		</tr>
	</table>
	</center>
	
	<h4>"Naive" Head-Mounted Measurements</h4>
	<p>
    The "Naive" Head-Mounted configuration places the sensors in a more realistic location. The sensor package is offset 4cm in each axis from the center of rotation (i.e. mounted on the user's head). With the accelerometer offset from the center of rotation, the sensor will experience acceleration due to gravity as well as acceleration due to rotation. In the naive configuration, the system makes no attempt to compensate for the acceleration due to rotation. The filter assumes the received accelerometer measurement is a noisy gravity vector and proceeds as before.
	</p>
	<center>
	<table>
		<tr>
			<td valign="top">
				<figure>
					<img src="/headertracker/images/ConfigurationResults/naive.gif" alt="Naive Simulation" height="400" width="500">
					<figcaption>Naive Simulation</figcaption>
				</figure>
			</td>
			<td valign="top" width="300">
				<figure>
					<img src="/headertracker/images/GeneralImages/NaiveDiagram.PNG" height="400" width="300">
					<figcaption>Sensor placement in naive configuration. Source: <a href="http://msl.cs.illinois.edu/~lavalle/papers/LavYerKatAnt14.pdf">Oculus VR</a></figcaption>
				</figure>
			</td>
		</tr>
	</table>
	</center>

	<h4>"Compensated" Head-Mounted Measurements</h4>
	<p>
	In the "Compensated" Head-Mounted configuration, the system attempts to compensate for the acceleration due to rotation. This requires knowledge of the headset angular velocity and angular acceleration, which we obtain from the gyroscope and a first order Euler approximation. Once the angular velocity and angular acceleration-dependent terms have been estimated, we subtract these values from the measured acceleration and pass the resulting gravity vector approximation to the filter.
	</p>
	<center>
	<table>
		<tr>
			<td valign="top">
				<figure>
					<img src="/headertracker/images/ConfigurationResults/compensated.gif" alt="Compensated Simulation" height="400" width="500">
					<figcaption>Compensated Simulation</figcaption>
				</figure>
			</td>
			<td valign="top" width="300">
				<figure>
					<img src="/headertracker/images/GeneralImages/CompensatedDiagram.PNG" height="400" width="300">
					<figcaption>Sensor placement in compensated configuration. Source: <a href="http://msl.cs.illinois.edu/~lavalle/papers/LavYerKatAnt14.pdf">Oculus VR</a></figcaption>
				</figure>
			</td>
		</tr>
	</table>
	</center>

	<h4>Constellation Head-Mounted Measurements</h4>
	<p>
	In the Constellation Head-Mounted configuration, the gyroscope has been removed from the system. Angular rate measurements are instead determined by a constellation of accelerometers. <a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=5551205&tag=1">Cardou et al.</a> and <a href="http://appliedmechanics.asmedigitalcollection.asme.org/data/journals/jamcav/930885/jam_081_11_111003.pdf">Zou et al.</a> provide excellent descriptions of this technique.
	</p>
	<p>
	The accelerometer constellation consists of eight accelerometers, arranged in symmetric pairs about the user's head. The key idea is that this symmetric pairing leads to cancelation when the measurements from paired accelerometers are summed. The angular acceleration terms drop out, and we can directly calculate the headset translational acceleration.
	</p>
	<p>
    The resulting translational acceleration then feeds into additional calculations for the headset's angular and tangential accelerations. We then approximate the angular velocity using trapezoidal integration of the computed angular acceleration.
	</p>
	<center>
	<table>
		<tr>
			<td valign="top">
				<figure>
					<img src="/headertracker/images/ConfigurationResults/constellation.gif" alt="Constellation Simulation" height="400" width="500">
					<figcaption>Constellation Simulation</figcaption>
				</figure>
			</td>
			<td valign="top" width="300">
				<figure>
					<img src="/headertracker/images/GeneralImages/ConstellationDiagram.PNG" height="400" width="300">
					<figcaption>Accelerometer constellation layout. Source: <a href="http://msl.cs.illinois.edu/~lavalle/papers/LavYerKatAnt14.pdf">Oculus VR</a></figcaption>
				</figure>
			</td>
		</tr>
	</table>
	</center>

	<h1>Side-by-Side Comparison</h1>
	<p>
	We simulated the headset rotating in all three axes. The simulation framework supports any input angular velocity signal; for these simulations, the angular velocity of all three axes was chosen to be a sine wave with a 144 deg/s amplitude and 2.5s period (parameters determined by the developers rotating their heads). The initial state estimate was initialized to a random quaternion of unit length.
	</p>
	<p>
	The headtracker quickly converges to the true head orientation in all of our simulations, with each of the four system configurations. However, the compensated system does experience some jitter in the state estimate, likely due to our first order Euler approximation for the angular acceleration. The root mean square error (RMSE) and filter computation times provide useful metrics for comparing each configuration:
	</p>
	<table>
		<tr>
			<th></th>
			<th>&psi; RMSE (deg)</th>
			<th>&theta; RMSE (deg)</th>
			<th>&phi; RMSE (deg)</th>
			<th>Single Iter Comp (ms)</th>
		</tr>
		<tr>
			<td>Center of Head</td>
			<td>0.0354</td>
			<td>0.0236</td>
			<td>0.0173</td>
			<td>0.2107</td>
		</tr>
		<tr>
			<td>Naive</td>
			<td>0.3097</td>
			<td>3.3644</td>
			<td>2.4064</td>
			<td>0.2200</td>
		</tr>
		<tr>
			<td>Compensated</td>
			<td>0.3910</td>
			<td>4.9697</td>
			<td>2.9544</td>
			<td>0.3311</td>
		</tr>
		<tr>
			<td>Constellation</td>
			<td>0.0752</td>
			<td>1.0250</td>
			<td>0.7659</td>
			<td>0.8950</td>
		</tr>
	</table>
	<p>
	The four configurations we considered all show promising attributes for virtual reality headtracking. The performance of the accelerometer constellation is particularly exciting; while this configuration requires more than twice the computation time of other methods, the entire system is still fast enough to be integrated into a real VR rendering pipeline.
	</p>
	<p>
	There are several directions for future work on this system. One opportunity is to fuse the angular rate measurements from a gyroscope with the accelerometer constellation. Another interesting study would be to implement a predictive scheme to compensate for the difference between the sensor measurement time and filter update time. Finally, we would like to deploy these systems on hardware!
	</p>

    </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>GitHub Contributors: <a href="https://github.com/mbanderson">Michael Anderson</a>, <a href="https://github.com/jinwoop">Jin Woo Park</a></p>
      </footer>
    </div>

  </body>
</html>
